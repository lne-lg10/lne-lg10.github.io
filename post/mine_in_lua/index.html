<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Lua掃雷算法 | 孤島浮生</title>

<meta property='og:title' content='Lua掃雷算法 - 孤島浮生'>
<meta property='og:description' content='剛剛完成了一個有點特別的掃雷遊戲，遊戲的邏輯全部是用 Lua 實現的。雖然不同的語言可以用來描述相同的思想，但是不同的語言'>
<meta property='og:url' content='https://lne-lg10.github.io/post/mine_in_lua/'>
<meta property='og:site_name' content='孤島浮生'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/6fbc37939d7715e07c9fd5523dddce3f?s=256'><meta property='article:author' content='https://facebook.com/heheda'><meta property='article:section' content='Post'><meta property='article:tag' content='Lua'><meta property='article:tag' content='人文'><meta property='article:published_time' content='2009-04-14T00:00:00Z'><meta property='article:modified_time' content='2009-04-14T00:00:00Z'><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@heheda'><meta name='twitter:creator' content='@heheda'>


<link href="https://lne-lg10.github.io/index.xml" rel="alternate" type="application/rss+xml" title="孤島浮生">

<link rel="stylesheet" href="/css/style.css"><link rel='stylesheet' href='https://lne-lg10.github.io/css/custom.css'>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://lne-lg10.github.io/post/mine_in_lua/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>

<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://lne-lg10.github.io">
          <h1 id="nav-heading" class="title is-4">孤島浮生</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/heheda'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="facebook" href='https://facebook.com/heheda'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/heheda'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="instagram" href='https://instagram.com/heheda'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
    <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
    <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:heheda@tutanota.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="rss" href='/index.xml'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
  <script src="/js/navicon-shift.js"></script>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="/tags/lua/">#Lua</a>



  
  | <a class="subtitle is-6" href="/tags/%E4%BA%BA%E6%96%87/">#人文</a>
  


      
    </div>
    <h2 class="subtitle is-6">April 14, 2009</h2>
    <h1 class="title">Lua掃雷算法</h1>
    
    <div class="content">
      <hr>
<p>剛剛完成了一個有點特別的掃雷遊戲，遊戲的邏輯全部是用 Lua 實現的。雖然不同的語言可以用來描述相同的思想，但是不同的語言亦會有不同的表達方式。從網上看到的各種版本的掃雷遊戲，實現算法大同小異，人云亦云，簡直就是應試教育的產物。就像畢卡索說的，有些畫家把太陽畫成一個黃斑，但有些畫家借助於他們的技巧和智慧把黃斑畫成太陽。我實在是沒有興趣重複別人走過的路，所以打算寫個不同的版本。<br>
設計一個遊戲的算法，剛開始的時候自然是考慮如何存儲遊戲過程中的數據。由於 Lua 語言本身的一些特性，我使用字符串來存儲這些數據，這樣可以方便的使用 Lua 內置的高效字符串庫來處理遊戲數據。<br>
假設掃雷遊戲的地圖大小為 width X height，那麼可以用一個長度為 width * height 的字符串來保存地圖數據。在遊戲過程中，需要兩份地圖數據，一份用來保存地圖的原始數據，其中記錄了地雷的分佈情況，以及地雷周圍的數字。另一份地圖用來保存當前在程序界面上顯示的地圖數據。地圖中每一個的小方格的狀態可以用這樣的一些字符來表示：</p>
<ul>
<li>&ldquo;0&rdquo;：表示空白區域</li>
<li>&ldquo;1&rdquo; ~ &ldquo;8&rdquo;：表示地雷周圍的數字區域，理論上一個小方格周圍最多可以存在 8 顆地雷，所以用數字 1~8 表示數字區域足夠了。</li>
<li>&ldquo;?&quot;：表示未知區域，這個是用於在程序界面上顯示的，原始地圖數據中不會出現這樣的字符。</li>
<li>&ldquo;@&quot;：表示地雷，之所以選擇這個字符，一是因為它比較形象，而是因為它的 ASCII 碼增加 1 就變成大寫字母 A 的 ASCII 碼。這在接下來的字符串處理中將有個巧妙的用處。</li>
</ul>
<p>地圖的數據結構定義好了，剩下的就該開始實現遊戲過程中的邏輯了。首先要實現的是在地圖上隨機放置地雷。首先生成一個全部字符為 &ldquo;0&rdquo; 的字符串。然後利用 Lua 數學庫中的隨機數生成函數產生一個處於 [1, len] 區間的數字，len 表示字符串的長度。將這個數字所對應位置處的字符替換為 &ldquo;@&rdquo; 就大功告成了。因為 Lua 沒有直接替換字符串指定位置處的函數，所以我是用字符串取子串和字符串連接來實現的（代碼第11行）。接下來的幾個函數中的字符替換方法也採用了相似的方式（代碼第13、15行）。<br>
需要注意的是，循環過程中隨機產生的數字有可能是重複的，為了能夠放置指定數量的地雷，需要在循環中判斷 &ldquo;@&rdquo; 字符的數量，如果達到指定數量的話才能退出循環（代碼第19行）。</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">lay_mine</span>(width, height, number)
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> len <span style="color:#719e07">=</span> width <span style="color:#719e07">*</span> height
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> number <span style="color:#719e07">&gt;</span> len <span style="color:#268bd2">then</span>
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">return</span> string.rep(<span style="color:#2aa198">&#34;@&#34;</span>, len)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> origin_map <span style="color:#719e07">=</span> string.rep(<span style="color:#2aa198">&#34;0&#34;</span>, len)  
</span></span><span style="display:flex;"><span>	math.randomseed(os.time())  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">while</span> <span style="color:#cb4b16">true</span> <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> pos <span style="color:#719e07">=</span> math.random(len)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> pos <span style="color:#719e07">==</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;@&#34;</span> <span style="color:#719e07">..</span> string.sub(origin_map, <span style="color:#2aa198">2</span>, len)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">elseif</span> pos <span style="color:#719e07">==</span> len <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, len <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">..</span> <span style="color:#2aa198">&#34;@&#34;</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">else</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, pos <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#2aa198">&#34;@&#34;</span> <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>			string.sub(origin_map, pos <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, len)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		count <span style="color:#719e07">=</span> select(<span style="color:#2aa198">2</span>, string.gsub(origin_map, <span style="color:#2aa198">&#34;@&#34;</span>, <span style="color:#2aa198">&#34;@&#34;</span>))  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> count <span style="color:#719e07">==</span> number <span style="color:#268bd2">then</span>  <span style="color:#268bd2">break</span> <span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	origin_map <span style="color:#719e07">=</span> take_count_of_mine(origin_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> origin_map  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>佈置好地雷之後，還需要計算與地雷相鄰區域的數字。這個算法很簡單，既可以依次查找空白區域，計算周圍 8 個區域中地雷的數量，也可以反過來，依次查找地雷區域，將周圍八個區域的字符加 1。考慮到一般地圖中地雷的數量是遠少於空白區域的，我採取第二種計算方法。按照上，下，左，右，左上，左下，右下，右上的順序把周圍區域的字符值加 1。如果超出地圖邊界的話，就跳過。</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">66
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">take_count_of_mine</span>(origin_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> i <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">while</span> <span style="color:#cb4b16">true</span> <span style="color:#268bd2">do</span>   
</span></span><span style="display:flex;"><span>		i <span style="color:#719e07">=</span> string.find(origin_map, <span style="color:#2aa198">&#34;[%u@]&#34;</span>, i <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> i <span style="color:#719e07">==</span> <span style="color:#cb4b16">nil</span> <span style="color:#268bd2">then</span> <span style="color:#268bd2">break</span> <span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> (i <span style="color:#719e07">-</span> width <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">-</span> width, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> (i <span style="color:#719e07">-</span> width <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">1</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> (i <span style="color:#719e07">+</span> width <span style="color:#719e07">&lt;</span> <span style="color:#719e07">#</span>origin_map <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">+</span> width, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> i <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span> <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">-</span> <span style="color:#2aa198">2</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> ((i <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">0</span>) <span style="color:#719e07">and</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> <span style="color:#2aa198">&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> (i <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">2</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> ((i <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">&lt;</span> <span style="color:#719e07">#</span>origin_map) <span style="color:#719e07">and</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">2</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> ((i <span style="color:#719e07">+</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">&lt;</span> (<span style="color:#719e07">#</span>origin_map <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>)) <span style="color:#719e07">and</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">+</span> width)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">+</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> ((i <span style="color:#719e07">-</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">0</span>) <span style="color:#719e07">and</span> (i <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> prefix <span style="color:#719e07">=</span> string.sub(origin_map, <span style="color:#2aa198">1</span>, i <span style="color:#719e07">-</span> width)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> postfix <span style="color:#719e07">=</span> string.sub(origin_map, i <span style="color:#719e07">-</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			postfix <span style="color:#719e07">=</span> string.gsub(postfix, <span style="color:#2aa198">&#34;[%d@%u]&#34;</span>, string.char(<span style="color:#2aa198">1</span> <span style="color:#719e07">+</span> string.byte(postfix)), <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			origin_map <span style="color:#719e07">=</span> prefix <span style="color:#719e07">..</span> postfix  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span> 
</span></span><span style="display:flex;"><span>	origin_map <span style="color:#719e07">=</span> string.gsub(origin_map, <span style="color:#2aa198">&#34;[%u]&#34;</span>, <span style="color:#2aa198">&#34;@&#34;</span>)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> origin_map  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>代碼比較長，其實算法很簡單。使用 Lua 的字符查找函數，依次查找地雷的位置，使用模式 &ldquo;[%u@]&rdquo; 進行匹配。模式 &ldquo;[%u@]&rdquo; 的含義是大寫字母或者 &ldquo;@&quot;，每當找到一顆地雷，就把周圍區域的字符值加 1。由於地雷周圍的區域中也可能存在地雷，加 1 之後，&rdquo;@&rdquo; 就會變成大寫字母，這也正是選擇 &ldquo;@&rdquo; 來表示地雷的原因，如此就可以方便的使用模式 &ldquo;[%u@]&rdquo; 來匹配字符。<br>
在執行加 1 操作的時候，要對所有的字符都加 1。空白 &ldquo;0&rdquo; 加 1 之後還是數字（對應的模式為&rdquo;%d&quot;），&quot;@&quot; 加 1 之後就會變成大寫字母（對應的模式為&quot;%u&quot;），所以在模式匹配的時候使用的模式為 &ldquo;[%d@%u]&quot;。</p>
<p>完成所有地雷區域的計算之後，要記得把地圖數據字符串中的大寫字母還原為 &ldquo;@&quot;（代碼第64行）。</p>
<p>掃雷遊戲中最核心的算法，當屬顯示空白區域的算法，當點中的方格位於一片空白區域之中時，遊戲界面上要把這一片空白區域以及包圍該區域的數字邊界都顯示出來。首先需要明確的一點是：包圍空白區域的方格只可能為數字，不可能含有地雷，這個可以用反證法證明。</p>
<p>網上關於這個算法的實現，幾乎都是低效地搜索相鄰的空白區域，直到遇到數字邊界為止，通常是用遞歸來實現的。我沒有採用這種算法，從本能上我就排斥類似於這樣的弱智算法。既然我採用字符串的形式來保存地圖數據，理所當然的，我也應當利用 Lua 內置的高效字符串處理庫來計算空白區。</p>
<p>另外，如果從效率上來考慮的話，最好是在第一次點擊某塊空格的時候，將所有的空白區域計算出來，並保存，以後每一次點擊空格操作，就只需要查找點擊的位置屬於那一片空白區，然後顯示出來即可。</p>
<p>思考算法實現的時候，單純從數學的角度去考慮，未免枯燥了點。不妨把自己想像成一位具有非凡勇氣的探險家，心懷夢想以及對未知世界的強烈渴望，駕駛著帆船航行於茫茫的大海，去探索新的海域，去發現新的大陸。嗯，再把時代背景安排在人類開始認識地球，觀察宇宙，思考人生的文藝復興時期，這樣去思考算法就比較生動有趣了。</p>
<p>在我的每一次航行中，我都會到達許多未知的海域。為了能夠探索到地球上全部的海域，我決定按照緯度，從零度經線開始向東行駛。每當完成一次環球旅行，我便向南行駛，到達一片新海域，然後繼續從零度經線向東行駛，周而複始，直到探索完全部的海域，繪製一張精確的航海圖，我的目的就達到了。</p>
<p>繪製一副精確的航海圖是一件十分困難的事情，因為海洋是巨大而神秘的，而我們人類只是滄海一粟，為了將未知的海域逐一探索，首先，我要按照緯度，把海洋分成不同的海域。同一緯度上，連續不斷的一片水域，我都把它們作為同一片海域對待。隨著旅程不斷增加，也許我會發現不同緯度的海域之間，它們在某一條或者多條經度線上，海水是互相連接著的，兩片海域彷彿有海峽相連，這樣，我就可以把這些水域在海圖上全部劃入相同的海域。最後，當我完成了全球探險之旅，我就可以知道，為陸地所包圍著的海洋，或者說被海洋所包圍著的陸地，究竟是什麼樣子的。某一片海洋，它的海面分佈是從北緯多少，到南緯多少，從西經多少，到東經多少，我都會航海圖上詳細標明，一目瞭然。當有人想知道某一個經緯度已知的位置位於哪一片海洋，我就可以查看繪製好的航海圖後，明確無誤地告訴他了。</p>
<p>首先，我必須在海圖上把相連的海域全部連成一片：</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">classfy_sea_area</span>(origin_map, current_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> uncharted_water <span style="color:#719e07">=</span> split_sea_area(origin_map, current_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> new_horizon <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">while</span> <span style="color:#719e07">#</span>uncharted_water <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">0</span> <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> u_w <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> sea_area <span style="color:#719e07">=</span> uncharted_water[<span style="color:#2aa198">1</span>]  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">for</span> i, v <span style="color:#268bd2">in</span> ipairs(uncharted_water) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> i <span style="color:#719e07">&gt;</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">local</span> n_h <span style="color:#719e07">=</span> has_strait_between(sea_area, v, width)  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">if</span> n_h <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>					sea_area <span style="color:#719e07">=</span> n_h  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">else</span>  
</span></span><span style="display:flex;"><span>					u_w[<span style="color:#719e07">#</span>u_w <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> v  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> <span style="color:#719e07">#</span>sea_area <span style="color:#719e07">==</span> <span style="color:#719e07">#</span>uncharted_water[<span style="color:#2aa198">1</span>] <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			new_horizon[<span style="color:#719e07">#</span>new_horizon <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> sea_area  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">else</span>  
</span></span><span style="display:flex;"><span>			u_w[<span style="color:#719e07">#</span>u_w <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> sea_area  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		uncharted_water <span style="color:#719e07">=</span> u_w   
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> new_horizon   
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>這樣來劃分海域：</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">split_sea_area</span>(origin_map, current_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> col <span style="color:#719e07">=</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> t3 <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">while</span> <span style="color:#cb4b16">true</span> <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> s1 <span style="color:#719e07">=</span> string.sub(origin_map, col, col <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> s2 <span style="color:#719e07">=</span> string.sub(current_map, col, col <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> i <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> j <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">while</span> <span style="color:#cb4b16">true</span> <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>			i, j <span style="color:#719e07">=</span> string.find(s2, <span style="color:#2aa198">&#34;?+&#34;</span>, j <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> i <span style="color:#719e07">==</span> <span style="color:#cb4b16">nil</span> <span style="color:#268bd2">then</span> <span style="color:#268bd2">break</span> <span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> s <span style="color:#719e07">=</span> string.sub(s1, i, j)  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> off1 <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> off2 <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">while</span> <span style="color:#cb4b16">true</span> <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>				off1, off2 <span style="color:#719e07">=</span> string.find(s, <span style="color:#2aa198">&#34;0+&#34;</span>, off2 <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">if</span> off1 <span style="color:#719e07">==</span> <span style="color:#cb4b16">nil</span> <span style="color:#268bd2">then</span> <span style="color:#268bd2">break</span> <span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">local</span> t1 <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>				t1[<span style="color:#719e07">#</span>t1 <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> col <span style="color:#719e07">+</span> i <span style="color:#719e07">+</span> off1 <span style="color:#719e07">-</span> <span style="color:#2aa198">2</span>  
</span></span><span style="display:flex;"><span>				t1[<span style="color:#719e07">#</span>t1 <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> col <span style="color:#719e07">+</span> i <span style="color:#719e07">+</span> off2 <span style="color:#719e07">-</span> <span style="color:#2aa198">2</span>  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">local</span> t2 <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>				t2[<span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> t1  
</span></span><span style="display:flex;"><span>				t3[<span style="color:#719e07">#</span>t3 <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> t2  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		col <span style="color:#719e07">=</span> col <span style="color:#719e07">+</span> width  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">if</span> col <span style="color:#719e07">&gt;</span> <span style="color:#719e07">#</span>origin_map <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">break</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> t3  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>兩片海域之間是否有海峽相鄰？可以這樣來判斷：</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">has_strait_between</span>(sea_area1, sea_area2, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">for</span> i1, v1 <span style="color:#268bd2">in</span> ipairs(sea_area1) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">for</span> i2, v2 <span style="color:#268bd2">in</span> ipairs(sea_area2) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> min_dist1 <span style="color:#719e07">=</span> v1[<span style="color:#2aa198">1</span>] <span style="color:#719e07">-</span> v2[<span style="color:#2aa198">2</span>] <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> max_dist1 <span style="color:#719e07">=</span> v1[<span style="color:#2aa198">2</span>] <span style="color:#719e07">-</span> v2[<span style="color:#2aa198">1</span>] <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> min_dist2 <span style="color:#719e07">=</span> v2[<span style="color:#2aa198">1</span>] <span style="color:#719e07">-</span> v1[<span style="color:#2aa198">2</span>] <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">local</span> max_dist2 <span style="color:#719e07">=</span> v2[<span style="color:#2aa198">2</span>] <span style="color:#719e07">-</span> v1[<span style="color:#2aa198">1</span>] <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> min_dist1 <span style="color:#719e07">&gt;=</span> <span style="color:#2aa198">0</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">if</span> (min_dist1 <span style="color:#719e07">&lt;</span> width <span style="color:#719e07">and</span> width <span style="color:#719e07">&lt;</span> max_dist1)   
</span></span><span style="display:flex;"><span>					<span style="color:#719e07">or</span> (min_dist1 <span style="color:#719e07">==</span> width <span style="color:#719e07">and</span> (v1[<span style="color:#2aa198">1</span>] <span style="color:#719e07">%</span> width) <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span>)   
</span></span><span style="display:flex;"><span>					<span style="color:#719e07">or</span> (max_dist1 <span style="color:#719e07">==</span> width <span style="color:#719e07">and</span> (v1[<span style="color:#2aa198">2</span>] <span style="color:#719e07">%</span> width) <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>					<span style="color:#268bd2">return</span> sea_area_union(sea_area1, sea_area2)  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">elseif</span> min_dist2 <span style="color:#719e07">&gt;=</span> <span style="color:#2aa198">0</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">if</span> (min_dist2 <span style="color:#719e07">&lt;</span> width <span style="color:#719e07">and</span> width <span style="color:#719e07">&lt;</span> max_dist2)   
</span></span><span style="display:flex;"><span>					<span style="color:#719e07">or</span> (min_dist2 <span style="color:#719e07">==</span> width <span style="color:#719e07">and</span> (v2[<span style="color:#2aa198">1</span>] <span style="color:#719e07">%</span> width) <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span>)   
</span></span><span style="display:flex;"><span>					<span style="color:#719e07">or</span> (max_dist2 <span style="color:#719e07">==</span> width <span style="color:#719e07">and</span> (v2[<span style="color:#2aa198">2</span>] <span style="color:#719e07">%</span> width) <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span>) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>					<span style="color:#268bd2">return</span> sea_area_union(sea_area1, sea_area2)  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>   
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> <span style="color:#cb4b16">nil</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>如果發現兩片海域屬於同一個海洋，那麼我需要在海圖上把兩片海域連起來：</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">sea_area_union</span>(a, b)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> c <span style="color:#719e07">=</span> {}  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">for</span> i,v <span style="color:#268bd2">in</span> ipairs(a) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		c[<span style="color:#719e07">#</span>c <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> v  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">for</span> i,v <span style="color:#268bd2">in</span> ipairs(b) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		c[<span style="color:#719e07">#</span>c <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>] <span style="color:#719e07">=</span> v  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> c  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>有了各個海域的精確位置以及分佈情況，就可以根據經緯度在大海上定位了：</p>
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">make_ocean_chart</span>(origin_map, current_map, width, position)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> ocean <span style="color:#719e07">=</span> classfy_sea_area(origin_map, current_map, width)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> ocean_index <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">for</span> i1, v1 <span style="color:#268bd2">in</span> ipairs(ocean) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">for</span> i2, v2 <span style="color:#268bd2">in</span> ipairs(v1) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">if</span> (position <span style="color:#719e07">&gt;=</span> v2[<span style="color:#2aa198">1</span>]) <span style="color:#719e07">and</span> (position <span style="color:#719e07">&lt;=</span> v2[<span style="color:#2aa198">2</span>]) <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>				ocean_index <span style="color:#719e07">=</span> i1  
</span></span><span style="display:flex;"><span>				<span style="color:#268bd2">break</span>  
</span></span><span style="display:flex;"><span>			<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> ocean_index <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">local</span> t <span style="color:#719e07">=</span> current_map  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">for</span> i, v <span style="color:#268bd2">in</span> ipairs(ocean[ocean_index]) <span style="color:#268bd2">do</span>  
</span></span><span style="display:flex;"><span>			t <span style="color:#719e07">=</span> make_coastline(origin_map, t, width, v)  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>		<span style="color:#268bd2">return</span> t, compare_map(current_map, t)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> current_map, <span style="color:#2aa198">&#34;&#34;</span>  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div>
<p>描繪大海的同時還要記得把海岸線也畫出來：
<div class="highlight"><div style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#495050">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#268bd2">function</span> <span style="color:#268bd2">make_coastline</span>(origin_map, current_map, width, sea_area)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> sea_area_west <span style="color:#719e07">=</span> sea_area[<span style="color:#2aa198">1</span>]  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">local</span> sea_area_east <span style="color:#719e07">=</span> sea_area[<span style="color:#2aa198">2</span>]  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> sea_area[<span style="color:#2aa198">1</span>] <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>		sea_area_west <span style="color:#719e07">=</span> sea_area_west <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> sea_area[<span style="color:#2aa198">2</span>] <span style="color:#719e07">%</span> width <span style="color:#719e07">~=</span> <span style="color:#2aa198">0</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>		sea_area_east <span style="color:#719e07">=</span> sea_area_east <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> sea_area_west <span style="color:#719e07">-</span> width <span style="color:#719e07">&gt;=</span> <span style="color:#2aa198">1</span> <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>		current_map <span style="color:#719e07">=</span> string.sub(current_map, <span style="color:#2aa198">1</span>, sea_area_west <span style="color:#719e07">-</span> width <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>		string.sub(origin_map, sea_area_west <span style="color:#719e07">-</span> width, sea_area_east <span style="color:#719e07">-</span> width) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>		string.sub(current_map, sea_area_east <span style="color:#719e07">-</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	current_map <span style="color:#719e07">=</span> string.sub(current_map, <span style="color:#2aa198">1</span>, sea_area_west <span style="color:#719e07">-</span> <span style="color:#2aa198">1</span>) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>	string.sub(origin_map, sea_area_west, sea_area_east) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>	string.sub(current_map, sea_area_east <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">if</span> sea_area_east <span style="color:#719e07">+</span> width <span style="color:#719e07">&lt;=</span> <span style="color:#719e07">#</span>current_map <span style="color:#268bd2">then</span>  
</span></span><span style="display:flex;"><span>		current_map <span style="color:#719e07">=</span> string.sub(current_map, <span style="color:#2aa198">1</span>, sea_area_west <span style="color:#719e07">+</span> width <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>		string.sub(origin_map, sea_area_west <span style="color:#719e07">+</span> width, sea_area_east <span style="color:#719e07">+</span> width) <span style="color:#719e07">..</span>  
</span></span><span style="display:flex;"><span>		string.sub(current_map, sea_area_east <span style="color:#719e07">+</span> width <span style="color:#719e07">+</span> <span style="color:#2aa198">1</span>, <span style="color:#719e07">-</span><span style="color:#2aa198">1</span>)  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">end</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#268bd2">return</span> current_map  
</span></span><span style="display:flex;"><span><span style="color:#268bd2">end</span>  </span></span></code></pre></td></tr></table>
</div>
</div></p>
<p>至此，掃雷遊戲的算法全部描述完畢。</p>

      
      <div class="related">

<h3>Similar articles:</h3>
<ul>
	
	<li><a href="/post/stellarium/">星之元素</a></li>
	
</ul>
</div>
      
    </div>
    
  </div>
</section>

    <script src="/js/copycode.js"></script>

<script src="https://utteranc.es/client.js"
        repo="[ENTER REPO HERE]"
        issue-term="url"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
  
    <script type="text/javascript">
      var disqus_shortname = 'heheda';
      function disqus() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }
  
      disqus();
  

    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p>Copyright © 2023 <a href="https://github.com/lne-lg10">山與</a>, All rights reserved. <br />  原創文章請勿轉載，謝謝！</p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/ribice/kiss">Kiss</a>.</p>
    
  </div>
</section>

<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="\/\/matomo.example.com\/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript>
  <img src="//matomo.example.com/piwik.php?idsite=1&amp;rec=1" style="border:0" alt="">
</noscript>

<script>
    (function(f, a, t, h, o, m){
        a[h]=a[h]||function(){
            (a[h].q=a[h].q||[]).push(arguments)
        };
        o=f.createElement('script'),
        m=f.getElementsByTagName('script')[0];
        o.async=1; o.src=t; o.id='fathom-script';
        m.parentNode.insertBefore(o,m)
    })(document, window, '\/\/fathom.example.com\/tracker.js', 'fathom');
    fathom('trackPageview');
</script>


</body>
</html>

